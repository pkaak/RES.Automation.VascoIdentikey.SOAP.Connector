<?xml version="1.0"?>
<!-- RES ONE Automation Building Blocks -->
<!-- Created by bnl\pkaak on 4/19/2017 2:28:58 PM -->
<AutomationManager>
	<buildingblock version="3.0">
		<projects/>
		<modules>
			<module>
				<properties>
					<guid>{57CDE41F-13B2-4EAA-92F0-E59CFAE25543}</guid>
					<name>1. Vasco - Open Admin Session</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.10</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>admin</name>
								<description/>
								<guid>{0A4FB10C-50AD-4664-B06C-8C4AFE6C4177}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{77479BB2-B2BF-4085-BBC6-89C5ADDB6EE0}">
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
						</parameters>
						<conditions>
							<condition guid="{86264E11-FD33-4D8D-849A-BDB44CDF7475}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{86264E11-FD33-4D8D-849A-BDB44CDF7475}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{EEB94510-A8AE-41DA-AB01-4811E16FBBD4}</guid>
					<name>2. Vasco - Close Admin Session</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.1</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>admin</name>
								<description/>
								<guid>{0A4FB10C-50AD-4664-B06C-8C4AFE6C4177}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{D7700D8F-D7A4-4F52-835C-03350E112DED}">
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{F7E50525-44A9-4CE3-8915-31148ABD6A96}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{F7E50525-44A9-4CE3-8915-31148ABD6A96}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionid = '$[SessionID]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logoff&gt;
&lt;attributeSet&gt;
&lt;attributes&gt;
        &lt;value xsi:type="xsd:string"&gt;$sessionid&lt;/value&gt;
        &lt;attributeID&gt;CREDFLD_SESSION_ID&lt;/attributeID&gt;
        &lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logoff&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logoffResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.logoffResponse.results.resultcodes.statusCode
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID

# Return SessionID 
$return = $xml.Envelope.Body.logoffResponse.results.resultcodes.returnCodeEnum + "|" + $xml.Envelope.Body.logoffResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{CD95562B-31A4-4A8B-890B-57290D15FBB2}</guid>
					<name>Get first value in the row</name>
					<enabled>yes</enabled>
					<description>Returns first value in the results (split by ;)
Needed to get serial number from a returned row</description>
					<version>1.0.6</version>
					<versioncomment/>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</guid>
								<folder>
									<name>Other</name>
									<description/>
									<guid>{6812E568-0299-4E0A-8AED-D47542D02D05}</guid>
								</folder>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>Results</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{66EA30A4-D78D-43D4-AE08-E0D911B5D9A3}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>Results</parametertrue>
								<setparameter>no</setparameter>
								<parameter>Resultss</parameter>
							</condition>
						</conditions>
						<variablescontainer></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{66EA30A4-D78D-43D4-AE08-E0D911B5D9A3}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source>$result = "$[Results]"
$array = $result.split(";")
echo $array[0]</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setoutparameter parse="no">$[Results]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{2AD48B88-62FE-4DDD-88B3-E0B3356FE15C}</guid>
					<name>Save Digipass QR</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.6</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</guid>
								<folder>
									<name>Other</name>
									<description/>
									<guid>{6812E568-0299-4E0A-8AED-D47542D02D05}</guid>
								</folder>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{8C522469-BCF8-4A25-8400-4F8DD4CACB89}">
							<param>
								<name>Filename</name>
								<value1>@[RANDOM(2000000000,2147483647,1)]-@[RANDOM(2000000000,2147483647,1)].gif</value1>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Base64</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>URL</name>
								<value1>^[VascoQRurl]$[Filename]</value1>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>SaveLocation</name>
								<value1>^[VascoQRshare]$[Filename]</value1>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{560565AB-5B3A-409C-8EA6-9222786C3E2D}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{B470DF3D-AE25-49DB-A165-EC3A7BC3D642}</guid><name>VascoQRurl</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1/></details></variable><variable><guid>{6B6EF5AD-D573-4A60-B947-D28D15602774}</guid><name>VascoQRshare</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1/></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{560565AB-5B3A-409C-8EA6-9222786C3E2D}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source>$b64 = '$[Base64]'
$filename = '$[SaveLocation]'

$bytes = [convert]::FromBase64String($b64)
[IO.File]::WriteAllBytes($filename, $bytes)</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{681EED44-17CF-402E-B940-26FCD935F652}</guid>
					<name>Assign Digipass</name>
					<enabled>yes</enabled>
					<description>Assign digipass serial to user.
</description>
					<version>1.0.7</version>
					<versioncomment/>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Digipass_Serial</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Grace_Period</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Grace period in days</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
								<selection/>
							</param>
						</parameters>
						<conditions>
							<condition guid="{EDAEEDBC-7BEA-40FD-B8CD-F4BC91D07603}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
							<condition guid="{BB4D99C2-B306-42B1-8C9A-901FCAD97DED}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{BB4D99C2-B306-42B1-8C9A-901FCAD97DED}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{EDAEEDBC-7BEA-40FD-B8CD-F4BC91D07603}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Assign digipass to user</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$digipassfld_serno = '$[Digipass_Serial]'
$digipassfld_assign_userid = '$[UserID]'
$digipassfld_grace_period_days = '$[Grace_Period]'
$digipassfld_domain = '$[Domain]'

$return = ''

# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:digipassExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;DIGIPASSCMD_ASSIGN&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$digipassfld_assign_userid&lt;/value&gt;
                &lt;attributeID&gt;DIGIPASSFLD_ASSIGNED_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:unsignedInt"&gt;$digipassfld_grace_period_days&lt;/value&gt;
                &lt;attributeID&gt;DIGIPASSFLD_GRACE_PERIOD_DAYS&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$digipassfld_serno&lt;/value&gt;
                &lt;attributeID&gt;DIGIPASSFLD_SERNO&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$digipassfld_domain&lt;/value&gt;
                &lt;attributeID&gt;DIGIPASSFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;              
              &lt;/attributeSet&gt;
        &lt;/adm:digipassExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.digipassExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.digipassExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.digipassExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
$return = $xml.Envelope.Body.digipassExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.digipassExecuteResponse.results.resultcodes.statusCodeEnum
$return
} #end showing results</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{DA717B6D-B972-4EDE-93D9-EDF8DEED4F61}</guid>
					<name>Get Digipass Activation and QR code</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.3</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{8CAC2116-018F-4530-AF31-73FE4BCB2FAB}">
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Digipass_Serial</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint/>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>QR_Code</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ActivationCode</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{752A91C0-8789-4E6F-9DBA-D82E7D04E911}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
							<condition guid="{F75C9807-D711-4134-B43E-1CA4E05626ED}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
							<condition guid="{531984D1-4AA1-450B-A52C-30B0B90C617F}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{531984D1-4AA1-450B-A52C-30B0B90C617F}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{752A91C0-8789-4E6F-9DBA-D82E7D04E911}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get QR code</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$digipassfld_serno = '$[Digipass_Serial]'

#getback: QR or Code
$getback = 'QR'

$return = ''
$digipassfld_full_activation_data = ''
$digipassfld_qr_code = ''


# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:digipassExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;DIGIPASSCMD_GENERATE_ACTIVATION_DATA&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$digipassfld_serno&lt;/value&gt;
                &lt;attributeID&gt;DIGIPASSFLD_SERNO&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;/attributeSet&gt;
        &lt;/adm:digipassExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.digipassExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.digipassExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.digipassExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
# count results

    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.digipassExecuteResponse.results.resultAttribute.attributes.count; $countAtrib++)
    { #set attributes
        $AttributeID = $xml.envelope.body.digipassExecuteResponse.results.resultAttribute.attributes[$countAtrib].attributeID
        if ($AttributeID -Match "DIGIPASSFLD_FULL_ACTIVATION_DATA") {
            $digipassfld_full_activation_data = $xml.Envelope.Body.digipassExecuteResponse.results.resultAttribute.attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "DIGIPASSFLD_QR_CODE") {
            $digipassfld_qr_code = $xml.Envelope.Body.digipassExecuteResponse.results.resultAttribute.attributes[$countAtrib].value.'#text'
        } #end set attributes
    } #next attribute

    # Return Results
    # Serial Number
    # Assign status
    # Type
    # Domain
    # Expired?
    # Grace period expired?
   
    if ($getback -match "QR") { $return = $digipassfld_qr_code }
    else { $return = $digipassfld_full_activation_data }

# give value on screen
$return
} #end showing results</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[QR_Code]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{F75C9807-D711-4134-B43E-1CA4E05626ED}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get full activation code</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$digipassfld_serno = '$[Digipass_Serial]'

#getback: QR or Code
$getback = 'Code'

$return = ''
$digipassfld_full_activation_data = ''
$digipassfld_qr_code = ''


# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:digipassExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;DIGIPASSCMD_GENERATE_ACTIVATION_DATA&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$digipassfld_serno&lt;/value&gt;
                &lt;attributeID&gt;DIGIPASSFLD_SERNO&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;/attributeSet&gt;
        &lt;/adm:digipassExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.digipassExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.digipassExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.digipassExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
# count results

    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.digipassExecuteResponse.results.resultAttribute.attributes.count; $countAtrib++)
    { #set attributes
        $AttributeID = $xml.envelope.body.digipassExecuteResponse.results.resultAttribute.attributes[$countAtrib].attributeID
        if ($AttributeID -Match "DIGIPASSFLD_FULL_ACTIVATION_DATA") {
            $digipassfld_full_activation_data = $xml.Envelope.Body.digipassExecuteResponse.results.resultAttribute.attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "DIGIPASSFLD_QR_CODE") {
            $digipassfld_qr_code = $xml.Envelope.Body.digipassExecuteResponse.results.resultAttribute.attributes[$countAtrib].value.'#text'
        } #end set attributes
    } #next attribute

    # Return Results
    # Serial Number
    # Assign status
    # Type
    # Domain
    # Expired?
    # Grace period expired?
   
    if ($getback -match "QR") { $return = $digipassfld_qr_code }
    else { $return = $digipassfld_full_activation_data }

# give value on screen
$return
} #end showing results</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[ActivationCode]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{F0B93697-F7BB-4B79-94A7-CCE9A2D6C2A5}</guid>
					<name>List Digipass Serial</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.6</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Return_Rows</name>
								<value1>0</value1>
								<value2/>
								<value3/>
								<type>0</type>
								<description>How many rows must be returnd.
Default = 0 = All rows
</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Assign Status</name>
								<value1>unassigned</value1>
								<value2>unassigned;assigned</value2>
								<value3>unassigned;assigned</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>Digipass type</name>
								<value1>MOB35</value1>
								<value2>MOB30;MOB35</value2>
								<value3>Mobile digipass 30;Mobile Digipass 35</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Expired digipasses</name>
								<value1>false</value1>
								<value2>false;true</value2>
								<value3>non-expired;expired</value3>
								<type>1</type>
								<description>Show expired or non-expired digipasses?</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>DigipassList_Result</name>
								<value1>$[Result]</value1>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{3F43983E-A391-464B-9390-23C067AA557B}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>ExitCode</parametertrue>
								<setparameter>no</setparameter>
								<parameter>ExitCode</parameter>
							</condition>
							<condition guid="{803A101B-84EC-40F1-BFF7-168FC6F7EAD0}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{803A101B-84EC-40F1-BFF7-168FC6F7EAD0}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get admin session ID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{3F43983E-A391-464B-9390-23C067AA557B}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>List digipass licenses</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$digipassfld_return_rows = $[Return_Rows]
$digipassfld_assign_status = "$[Assign Status]"
$digipass_type = "$[Digipass type]"
$digipass_domain = "$[Domain]"
$digipassfld_expired = '$[Expired digipasses]'

$return = ''
$digipassfld_serno = ''
$digipassfld_grace_period_expired =

# create xmlbocy
$Batch = [XML] @"
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"&gt;
&lt;SOAP-ENV:Header/&gt;
&lt;SOAP-ENV:Body&gt;
&lt;adm:digipassQuery xmlns:adm= "http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"
xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
&lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
&lt;attributeSet&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$digipass_type&lt;/value&gt;
&lt;attributeID&gt;DIGIPASSFLD_DPTYPE&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes xsi:type="DIGIPASS-TYPES:DigipassAttribute"&gt;
                            &lt;value xsi:type="xsd:string"&gt;$digipass_domain&lt;/value&gt;
                            &lt;attributeID&gt;DIGIPASSFLD_DOMAIN&lt;/attributeID&gt;
        &lt;/attributes&gt;
                        &lt;attributes xsi:type="DIGIPASS-TYPES:DigipassAttribute"&gt;
                            &lt;value xsi:type="xsd:string"&gt;$digipassfld_assign_status&lt;/value&gt;
                            &lt;attributeID&gt;DIGIPASSFLD_ASSIGN_STATUS&lt;/attributeID&gt;
                        &lt;/attributes&gt;        
                        &lt;attributes xsi:type="DIGIPASS-TYPES:DigipassAttribute"&gt;
                            &lt;value xsi:type="xsd:boolean"&gt;$digipassfld_expired&lt;/value&gt;
                            &lt;attributeID&gt;DIGIPASSFLD_EXPIRED&lt;/attributeID&gt;
                        &lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;fieldSet/&gt;
            &lt;queryOptions&gt;
                &lt;sortorder&gt;QUERYOPTIONSORTORDER_DESCENDING&lt;/sortorder&gt;
                &lt;rowcount&gt;$digipassfld_return_rows&lt;/rowcount&gt;
            &lt;/queryOptions&gt;

&lt;/adm:digipassQuery&gt;
&lt;/SOAP-ENV:Body&gt;
&lt;/SOAP-ENV:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.digipassQueryResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.digipassQueryResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.digipassQueryResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
# count results
$max = $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList.Count - 1

if ($max -notmatch "-1") {
# more than 1 result back, loop through returned values for results
for ($count = 0; $count -lt $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList.Count; $count++)
{  # set results, loop response 
    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList[$count].attributes.Count; $countAtrib++)
    { #set attributes
        $AttributeID = $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].attributeID
        if ($AttributeID -Match "DIGIPASSFLD_SERNO") {
            $digipassfld_serno = $xml.Envelope.Body.digipassQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "DIGIPASSFLD_GRACE_PERIOD_EXPIRED") {
            $digipassfld_grace_period_expired = $xml.Envelope.Body.digipassQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        } #end set attributes
    } #next attribute

    # Return Results
    # Serial Number
    # Assign status
    # Type
    # Domain
    # Expired?
    # Grace period expired?
   
    $return = $return + $digipassfld_serno + ";" + $digipassfld_assign_status  + ";" + $digipass_type + ";" + $digipass_domain + ";" + $digipassfld_expired + ";" + $digipassfld_grace_period_expired
    if ($count -lt $max) {
        $return = $return + "|"
    } #next result

 }
} 
else {
# return one result
    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList.attributes.count; $countAtrib++)
    { #set attributes
        $AttributeID = $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].attributeID
        if ($AttributeID -Match "DIGIPASSFLD_SERNO") {
            $digipassfld_serno = $xml.Envelope.Body.digipassQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "DIGIPASSFLD_GRACE_PERIOD_EXPIRED") {
            $digipassfld_grace_period_expired = $xml.Envelope.Body.digipassQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].value.'#text'
        } #end set attributes
    } #next attribute

    # Return Results
    # Serial Number
    # Assign status
    # Type
    # Domain
    # Expired?
    # Grace period expired?
   
    $return = $return + $digipassfld_serno + ";" + $digipassfld_assign_status  + ";" + $digipass_type + ";" + $digipass_domain + ";" + $digipassfld_expired + ";" + $digipassfld_grace_period_expired


}
# give value on screen
$return
} #end showing results</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{F20AE6D6-EB55-4C4B-895B-4A1C1CA5CFB8}</guid>
					<name>List first free digipass serial</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.8</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Return_Rows</name>
								<value1>1</value1>
								<value2/>
								<value3/>
								<type>0</type>
								<description>How many rows must be returnd.
Default = 0 = All rows</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Assign Status</name>
								<value1>unassigned</value1>
								<value2>unassigned;assigned</value2>
								<value3>unassigned;assigned</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>Digipass type</name>
								<value1>MOB35</value1>
								<value2>MOB30;MOB35</value2>
								<value3>Mobile digipass 30;Mobile Digipass 35</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Expired digipasses</name>
								<value1>false</value1>
								<value2>false;true</value2>
								<value3>non-expired;expired</value3>
								<type>1</type>
								<description>Show expired or non-expired digipasses?</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>DigipassList_Result</name>
								<value1>$[Result]</value1>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>Results</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection/>
							</param>
							<param>
								<name>Digipass_serial</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{48E2B02B-6741-490E-AD22-9EB1B9F23F94}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>ExitCode</parametertrue>
								<setparameter>no</setparameter>
								<parameter>ExitCode</parameter>
							</condition>
							<condition guid="{8ED93089-6DE0-4C15-B78C-CAFB2088D6E7}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
							<condition guid="{ED8A84FE-14E1-4D7D-A127-8CDF8307954A}">
								<expressions>
									<expression guid="{E30D557C-18C3-4961-B5EF-12B528458990}">
										<operand>ExitCode</operand>
										<operator>=</operator>
										<value>0</value>
										<type>8</type>
									</expression>
								</expressions>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>2</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>Results</parametertrue>
								<setparameter>no</setparameter>
								<parameter>ExitCode</parameter>
							</condition>
							<condition guid="{177D95A9-7061-4A5D-9D3B-4137ECDC7EB4}">
								<expressions>
									<expression guid="{2C574FB8-CA6E-42D9-8CD3-6104949B8C9E}">
										<operand>Digipass_serial</operand>
										<operator>NOT LIKE</operator>
										<value></value>
										<type>8</type>
									</expression>
								</expressions>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<setparametertrue>no</setparametertrue>
								<parametertrue>ExitCode</parametertrue>
								<when>0</when>
								<action>2</action>
								<setparameter>no</setparameter>
								<parameter>ExitCode</parameter>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{8ED93089-6DE0-4C15-B78C-CAFB2088D6E7}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get admin session ID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{48E2B02B-6741-490E-AD22-9EB1B9F23F94}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>List digipass licenses</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$digipassfld_return_rows = $[Return_Rows]
$digipassfld_assign_status = "$[Assign Status]"
$digipass_type = "$[Digipass type]"
$digipass_domain = "$[Domain]"
$digipassfld_expired = '$[Expired digipasses]'

$return = ''
$digipassfld_serno = ''
$digipassfld_grace_period_expired =

# create xmlbocy
$Batch = [XML] @"
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"&gt;
&lt;SOAP-ENV:Header/&gt;
&lt;SOAP-ENV:Body&gt;
&lt;adm:digipassQuery xmlns:adm= "http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"
xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
&lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
&lt;attributeSet&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$digipass_type&lt;/value&gt;
&lt;attributeID&gt;DIGIPASSFLD_DPTYPE&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes xsi:type="DIGIPASS-TYPES:DigipassAttribute"&gt;
                            &lt;value xsi:type="xsd:string"&gt;$digipass_domain&lt;/value&gt;
                            &lt;attributeID&gt;DIGIPASSFLD_DOMAIN&lt;/attributeID&gt;
        &lt;/attributes&gt;
                        &lt;attributes xsi:type="DIGIPASS-TYPES:DigipassAttribute"&gt;
                            &lt;value xsi:type="xsd:string"&gt;$digipassfld_assign_status&lt;/value&gt;
                            &lt;attributeID&gt;DIGIPASSFLD_ASSIGN_STATUS&lt;/attributeID&gt;
                        &lt;/attributes&gt;        
                        &lt;attributes xsi:type="DIGIPASS-TYPES:DigipassAttribute"&gt;
                            &lt;value xsi:type="xsd:boolean"&gt;$digipassfld_expired&lt;/value&gt;
                            &lt;attributeID&gt;DIGIPASSFLD_EXPIRED&lt;/attributeID&gt;
                        &lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;fieldSet/&gt;
            &lt;queryOptions&gt;
                &lt;sortorder&gt;QUERYOPTIONSORTORDER_DESCENDING&lt;/sortorder&gt;
                &lt;rowcount&gt;$digipassfld_return_rows&lt;/rowcount&gt;
            &lt;/queryOptions&gt;

&lt;/adm:digipassQuery&gt;
&lt;/SOAP-ENV:Body&gt;
&lt;/SOAP-ENV:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.digipassQueryResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.digipassQueryResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.digipassQueryResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
# count results
$max = $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList.Count - 1

if ($max -notmatch "-1") {
# more than 1 result back, loop through returned values for results
for ($count = 0; $count -lt $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList.Count; $count++)
{  # set results, loop response 
    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList[$count].attributes.Count; $countAtrib++)
    { #set attributes
        $AttributeID = $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].attributeID
        if ($AttributeID -Match "DIGIPASSFLD_SERNO") {
            $digipassfld_serno = $xml.Envelope.Body.digipassQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "DIGIPASSFLD_GRACE_PERIOD_EXPIRED") {
            $digipassfld_grace_period_expired = $xml.Envelope.Body.digipassQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        } #end set attributes
    } #next attribute

    # Return Results
    # Serial Number
    # Assign status
    # Type
    # Domain
    # Expired?
    # Grace period expired?
   
    $return = $return + $digipassfld_serno + ";" + $digipassfld_assign_status  + ";" + $digipass_type + ";" + $digipass_domain + ";" + $digipassfld_expired + ";" + $digipassfld_grace_period_expired
    if ($count -lt $max) {
        $return = $return + "|"
    } #next result

 }
} 
else {
# return one result
    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList.attributes.count; $countAtrib++)
    { #set attributes
        $AttributeID = $xml.envelope.body.digipassQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].attributeID
        if ($AttributeID -Match "DIGIPASSFLD_SERNO") {
            $digipassfld_serno = $xml.Envelope.Body.digipassQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "DIGIPASSFLD_GRACE_PERIOD_EXPIRED") {
            $digipassfld_grace_period_expired = $xml.Envelope.Body.digipassQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].value.'#text'
        } #end set attributes
    } #next attribute

    # Return Results
    # Serial Number
    # Assign status
    # Type
    # Domain
    # Expired?
    # Grace period expired?
   
    $return = $return + $digipassfld_serno + ";" + $digipassfld_assign_status  + ";" + $digipass_type + ";" + $digipass_domain + ";" + $digipassfld_expired + ";" + $digipassfld_grace_period_expired


}
# give value on screen
$return
} #end showing results</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{ED8A84FE-14E1-4D7D-A127-8CDF8307954A}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get only the Vasco Serial number</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source>$result = "$[Result]"
$array = $result.split(";")
echo $array[0]</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setoutparameter parse="no">$[Digipass_serial]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>WAIT</type>
							<guid>{177D95A9-7061-4A5D-9D3B-4137ECDC7EB4}</guid>
							<description>Postpone Job</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<askconsoleuser>no</askconsoleuser>
							<wait unit="second">1</wait>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{79A04073-1A82-4578-9FC2-0DA5DFA4CA56}</guid>
					<name>Unassign Digipass</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.2</version>
					<versioncomment/>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Digipass_Serial</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
								<selection/>
							</param>
						</parameters>
						<conditions>
							<condition guid="{F6AC5892-3300-492F-BDBA-D2145293B1E7}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
							<condition guid="{7504AA7F-4593-4CC2-BB7B-A2872C3C18CD}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{7504AA7F-4593-4CC2-BB7B-A2872C3C18CD}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{F6AC5892-3300-492F-BDBA-D2145293B1E7}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Unassign digipass to user</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$digipassfld_serno = '$[Digipass_Serial]'
$digipassfld_domain = '$[Domain]'

$return = ''

# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:digipassExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;DIGIPASSCMD_UNASSIGN&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$digipassfld_serno&lt;/value&gt;
                &lt;attributeID&gt;DIGIPASSFLD_SERNO&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$digipassfld_domain&lt;/value&gt;
                &lt;attributeID&gt;DIGIPASSFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;              
              &lt;/attributeSet&gt;
        &lt;/adm:digipassExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.digipassExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.digipassExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.digipassExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
$return = $xml.Envelope.Body.digipassExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.digipassExecuteResponse.results.resultcodes.statusCodeEnum
$return
} #end showing results</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{876424D4-C377-45F3-B047-1F3905D6B679}</guid>
					<name>Create Domain</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.6</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Domains</name>
								<description/>
								<guid>{76339061-E4E8-4773-8B48-403E2A7BFA2C}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{C4F42ED4-CFBC-48BB-8ECA-B4D010FCCA8D}">
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Description</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{00659619-4AEE-4181-BB6E-F9EE72B807DF}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
							<condition guid="{64E499A7-EB6F-44D1-91B8-31C874F677FB}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{64E499A7-EB6F-44D1-91B8-31C874F677FB}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{00659619-4AEE-4181-BB6E-F9EE72B807DF}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Create Vasco Domain</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$domainfld_domain = '$[Domain]'
$domainfld_description = '$[Description]'

# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:domainExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;DOMAINCMD_CREATE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$domainfld_domain&lt;/value&gt;
                &lt;attributeID&gt;DOMAINFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$domainfld_description&lt;/value&gt;
                &lt;attributeID&gt;DOMAINFLD_DESCRIPTION&lt;/attributeID&gt;
              &lt;/attributes&gt;                
              &lt;/attributeSet&gt;
        &lt;/adm:domainExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.domainExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.domainExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.domainExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID

# Return SessionID 
$return = $xml.Envelope.Body.domainExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.domainExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{19427381-2B44-4BCB-BA84-8BC906FF9B5E}</guid>
					<name>Delete Domain</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.5</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Domains</name>
								<description/>
								<guid>{76339061-E4E8-4773-8B48-403E2A7BFA2C}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{BB53C8D3-4D77-496D-9E93-DB94A7172AF8}">
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{91AA1037-85A1-4D6D-97FB-9A0939D2E2D7}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>Domain</parametertrue>
								<setparameter>no</setparameter>
								<parameter>Domain</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{87BA814E-E01D-4B96-85CD-D898201B5148}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{91AA1037-85A1-4D6D-97FB-9A0939D2E2D7}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Delete Vasco Domain</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$domainfld_domain = '$[Domain]'

# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:domainExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;DOMAINCMD_DELETE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$domainfld_domain&lt;/value&gt;
                &lt;attributeID&gt;DOMAINFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;             
              &lt;/attributeSet&gt;
        &lt;/adm:domainExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.domainExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.domainExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.domainExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID

# Return SessionID 
$return = $xml.Envelope.Body.domainExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.domainExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{E90B449F-9C82-4761-A4F1-7704F44FDCD8}</guid>
					<name>List Domains</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.10</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Domains</name>
								<description/>
								<guid>{76339061-E4E8-4773-8B48-403E2A7BFA2C}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{DDE30F35-0E67-4EB5-84D2-EFEDB920142E}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{94EA4375-0D1E-41ED-B492-16157956D4B3}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{DDE30F35-0E67-4EB5-84D2-EFEDB920142E}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>List Vasco Domains</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$domainfld_domain = ''
$domainfld_description = ''
$domainfld_masterdomain = ''

$return = ''

# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:domainQuery&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;attributeSet&gt;
              &lt;/attributeSet&gt;
            &lt;fieldSet/&gt;
            &lt;queryOptions&gt;
                &lt;sortorder&gt;QUERYOPTIONSORTORDER_ASCENDING&lt;/sortorder&gt;
            &lt;/queryOptions&gt;
        &lt;/adm:domainQuery&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.domainQueryResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.domainQueryResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.domainQueryResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values for results

$max = $xml.envelope.body.domainQueryResponse.results.resultAttribute.attributeList.Count - 1

if ($max -notmatch "-1") {
for ($count = 0; $count -lt $xml.envelope.body.domainQueryResponse.results.resultAttribute.attributeList.Count; $count++)
{ 
    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.domainQueryResponse.results.resultAttribute.attributeList[$count].attributes.Count; $countAtrib++)
    {
        $AttributeID = $xml.envelope.body.domainQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].attributeID
        if ($AttributeID -Match "DOMAINFLD_DOMAIN") {
            $domainfld_domain = $xml.Envelope.Body.domainQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "DOMAINFLD_DESCRIPTION") {
            $domainfld_description = $xml.Envelope.Body.domainQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
        ELSEif ($AttributeID -Match "DOMAINFLD_MASTERDOMAIN") {
            $domainfld_masterdomain = $xml.Envelope.Body.domainQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
    }
    # Return Results
    $return = $return + $domainfld_domain + ";" + $domainfld_description + ";" + $domainfld_masterdomain
    if ($count -lt $max) {
        $return = $return + "|"
    }
   }
}
   else
   {

    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.domainQueryResponse.results.resultAttribute.attributeList.attributes.Count; $countAtrib++)
    {
        $AttributeID = $xml.envelope.body.domainQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].attributeID
        if ($AttributeID -Match "DOMAINFLD_DOMAIN") {
            $domainfld_domain = $xml.Envelope.Body.domainQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "DOMAINFLD_DESCRIPTION") {
            $domainfld_description = $xml.Envelope.Body.domainQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].value.'#text'
        }
        ELSEif ($AttributeID -Match "DOMAINFLD_MASTERDOMAIN") {
            $domainfld_masterdomain = $xml.Envelope.Body.domainQueryResponse.results.resultAttribute.attributeList.attributes[$countAtrib].value.'#text'
        }
    }
    # Return Results
    $return = $domainfld_domain + ";" + $domainfld_description + ";" + $domainfld_masterdomain
    }
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{68113563-4C7C-476E-A3DE-1B864C848277}</guid>
					<name>Create OU</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.5</version>
					<versioncomment/>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Organizational Units</name>
								<description/>
								<guid>{16BF9C9C-42FC-441A-90B3-225FA0CBC05F}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Description</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Organizational Unit</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Parent Organizational Unit</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{FE68CA2E-ABB0-4307-9F50-D85C77AAF9FF}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
							<condition guid="{6F7F8698-B259-4A82-9426-07F03F21577C}">
								<expressions/>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{6F7F8698-B259-4A82-9426-07F03F21577C}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{FE68CA2E-ABB0-4307-9F50-D85C77AAF9FF}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$orgunitfld_domain = '$[Domain]'
$orgunitfld_description = '$[Description]'
$orgunitfld_ou = '$[Organizational Unit]'
$orgunitfld_parent_ou = '$[Parent Organizational Unit]'

# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:orgunitExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;ORGUNITCMD_CREATE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_domain&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_ou&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_ORGANIZATIONAL_UNIT&lt;/attributeID&gt;
              &lt;/attributes&gt;                
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_parent_ou&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_PARENT_ORGANIZATIONAL_UNIT&lt;/attributeID&gt;
              &lt;/attributes&gt;                
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_description&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_DESCRIPTION&lt;/attributeID&gt;
              &lt;/attributes&gt;
&lt;/attributeSet&gt;
        &lt;/adm:orgunitExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.orgunitExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.orgunitExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID

# Return SessionID 
$return = $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{00EE0903-1240-4060-B1AB-2AF98FAEA29A}</guid>
					<name>Delete OU</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.3</version>
					<versioncomment/>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Organizational Units</name>
								<description/>
								<guid>{16BF9C9C-42FC-441A-90B3-225FA0CBC05F}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Organizational Unit</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{09BDCECC-88C1-4F27-87FF-6B6FDCC5FD43}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{3A43C648-89FA-413C-A64B-7400DFD6C90D}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{09BDCECC-88C1-4F27-87FF-6B6FDCC5FD43}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$orgunitfld_domain = '$[Domain]'
$orgunitfld_ou = '$[Organizational Unit]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:orgunitExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;ORGUNITCMD_DELETE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_domain&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_ou&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_ORGANIZATIONAL_UNIT&lt;/attributeID&gt;
              &lt;/attributes&gt;                
&lt;/attributeSet&gt;
        &lt;/adm:orgunitExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.orgunitExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.orgunitExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID

# Return SessionID 
$return = $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{EE1C8201-4932-4734-99F2-6FD902734686}</guid>
					<name>List OU</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.2</version>
					<versioncomment/>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Organizational Units</name>
								<description/>
								<guid>{16BF9C9C-42FC-441A-90B3-225FA0CBC05F}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{0B7B2B3F-D0B6-4D24-97B8-5256B8B23F1E}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{A50E7749-2964-46FB-A6CC-A0D2E9E0BEEC}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{0B7B2B3F-D0B6-4D24-97B8-5256B8B23F1E}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$orgunitfld_domain = ''
$orgunitfld_description = ''
$orgunitfld_ou = ''
$orgunitfld_parent_ou = ''
$return = ''

# create xmlbocy
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:orgunitQuery&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;attributeSet&gt;
            &lt;/attributeSet&gt;
            &lt;fieldSet&gt;
            &lt;/fieldSet&gt;
        &lt;/adm:orgunitQuery&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.orgunitQueryResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.orgunitQueryResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.orgunitQueryResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values for results

$max = $xml.envelope.body.orgunitQueryResponse.results.resultAttribute.attributeList.Count - 1
for ($count = 0; $count -lt $xml.envelope.body.orgunitQueryResponse.results.resultAttribute.attributeList.Count; $count++)
{ 
    for ($countAtrib = 0; $countAtrib -lt $xml.envelope.body.orgunitQueryResponse.results.resultAttribute.attributeList[$count].attributes.Count; $countAtrib++)
    {
        $AttributeID = $xml.envelope.body.orgunitQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].attributeID
        if ($AttributeID -Match "ORGUNITFLD_DOMAIN") {
            $orgunitfld_domain = $xml.Envelope.Body.orgunitQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
        elseif ($AttributeID -Match "ORGUNITFLD_DESCRIPTION") {
            $orgunitfld_description = $xml.Envelope.Body.orgunitQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
        ELSEif ($AttributeID -Match "ORGUNITFLD_ORGANIZATIONAL_UNIT") {
            $orgunitfld_ou = $xml.Envelope.Body.orgunitQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
        ELSEif ($AttributeID -Match "ORGUNITFLD_PARENT_ORGANIZATIONAL_UNIT") {
            $orgunitfld_parent_ou = $xml.Envelope.Body.orgunitQueryResponse.results.resultAttribute.attributeList[$count].attributes[$countAtrib].value.'#text'
        }
    }
    # Return Results
    # OU naam
    # Domain
    # Parent OU
    # Description
   
    $return = $return + $orgunitfld_ou + ";" + $orgunitfld_domain  + ";" + $orgunitfld_parent_ou + ";" + $orgunitfld_description
    if ($count -lt $max) {
        $return = $return + "|"
    }

}
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{4FFE57DE-57AA-4E27-99B0-725AB2A0DE10}</guid>
					<name>Update OU</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.2</version>
					<versioncomment/>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Organizational Units</name>
								<description/>
								<guid>{16BF9C9C-42FC-441A-90B3-225FA0CBC05F}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Description</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Organizational Unit</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{19BE8075-8487-477A-92D2-9A5B9B0227DE}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{8B131964-9DAC-4AD4-A5C3-2A0F17A69425}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Get Admin sessionID</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{19BE8075-8487-477A-92D2-9A5B9B0227DE}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$orgunitfld_domain = '$[Domain]'
$orgunitfld_description = '$[Description]'
$orgunitfld_ou = '$[Organizational Unit]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:orgunitExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;ORGUNITCMD_UPDATE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_domain&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_ou&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_ORGANIZATIONAL_UNIT&lt;/attributeID&gt;
              &lt;/attributes&gt;                
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$orgunitfld_description&lt;/value&gt;
                &lt;attributeID&gt;ORGUNITFLD_DESCRIPTION&lt;/attributeID&gt;
              &lt;/attributes&gt;
&lt;/attributeSet&gt;
        &lt;/adm:orgunitExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.orgunitExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.orgunitExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID

# Return SessionID 
$return = $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.orgunitExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{370F7679-0227-48E2-96CD-74F359144031}</guid>
					<name>Create User</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.14</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{4E4C601C-928D-4A4F-B93C-D4F45D097B50}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>OrganizationUnit</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars
OU needs to be available in the domain</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Username</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Full name of the user</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Email</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Phone</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars
</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Mobile</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars
</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Description</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 1024 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Password</name>
								<value1/>
								<value2/>
								<value3/>
								<type>5</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>LocalAuth</name>
								<value1>default</value1>
								<value2>default;none;digipass only;digipass/password;digipass or password</value2>
								<value3>Default;None;Digipass Only;Digipass/Password;Digipass or Password</value3>
								<type>1</type>
								<description>Default: the value from the related policy is
used.

None: no local authentication is performed.

Digipass Only: the user can only authenticate using their DIGIPASS.

DIGIPASS/Password: As long as the grace period for the DIGIPASS authenticatorhas not expired, the user can use either their authenticator
or their static password to log in. After the grace period has expired, only authentications with DIGIPASS can be performed.

DIGIPASS or Password: The user can use both their DIGIPASS authenticator or their static password for authentication, independent of the grace period. Use of this authentication mode is subject to licensing.</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>BackendAuth</name>
								<value1>default</value1>
								<value2>default;none;if needed;always</value2>
								<value3>Default;None;If needed;Always</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>Disabled</name>
								<value1>false</value1>
								<value2>true;false</value2>
								<value3>True;False</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>Locked</name>
								<value1>false</value1>
								<value2>true;false</value2>
								<value3>True;False</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>OfflineAuthEnabled</name>
								<value1>default</value1>
								<value2>default;yes;no</value2>
								<value3>Default;Yes;No</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{C95A84C6-2CBC-497F-8DB3-E13FE4C165E5}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
							<condition guid="{E462DE6F-7E49-41F7-8164-DB36976446B9}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{E462DE6F-7E49-41F7-8164-DB36976446B9}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{C95A84C6-2CBC-497F-8DB3-E13FE4C165E5}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Create user</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'
$userfld_email = '$[Email]'
$userfld_mobile = '$[Mobile]'
$userfld_description = '$[Description]'
$userfld_password = '$[Password]'
$userfld_local_auth = '$[LocalAuth]'
$userfld_backend_auth = '$[BackendAuth]'
$userfld_disabled = '$[Disabled]'
$userfld_locked = '$[Locked]'
$userfld_offline_auth_enabled = '$[OfflineAuthEnabled]'
$userfld_phone = '$[Phone]'
$userfld_organizational_unit = '$[OrganizationUnit]' 
$userfld_username = '$[Username]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_CREATE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_username&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERNAME&lt;/attributeID&gt;
              &lt;/attributes&gt;  
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_email&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_EMAIL&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_mobile&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_MOBILE&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_description&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DESCRIPTION&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_password&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_PASSWORD&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_local_auth&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_LOCAL_AUTH&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_backend_auth&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_BACKEND_AUTH&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:boolean"&gt;$userfld_disabled&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DISABLED&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:boolean"&gt;$userfld_locked&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_LOCKED&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_offline_auth_enabled&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_OFFLINE_AUTH_ENABLED&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_phone&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_PHONE&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_organizational_unit&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_ORGANIZATIONAL_UNIT&lt;/attributeID&gt;
              &lt;/attributes&gt;              

              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return status OK
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{B4482ADE-76FF-44AE-921C-E48599BE7629}</guid>
					<name>Delete User</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.7</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{CC5ED1EB-E4A4-4BAD-86F1-C5A9B9393B21}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{29740E0D-10E4-4A81-A7B3-2650EB142365}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
							<condition guid="{466B3746-EEB5-44BA-ADB4-FE1713376CF3}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
								<setparametertrue>no</setparametertrue>
								<parametertrue>SessionID</parametertrue>
								<setparameter>no</setparameter>
								<parameter>SessionID</parameter>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{466B3746-EEB5-44BA-ADB4-FE1713376CF3}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{29740E0D-10E4-4A81-A7B3-2650EB142365}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Delete user</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_DELETE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;

              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{E904E28A-090A-47D8-A5C3-8220EF9AEDD6}</guid>
					<name>Disable User</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.6</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{13FEC232-8FD1-4DD6-A6D8-3850285BFF75}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{E4C8A39F-0D28-43B7-8160-6237371B6799}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{70A269A3-00EC-4BB1-B6E5-E026F6FCF922}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{E4C8A39F-0D28-43B7-8160-6237371B6799}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Disable user</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_DISABLE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;

              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{67A363D9-7734-4B5D-B956-FB68D3FF40A5}</guid>
					<name>Enable User</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.5</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{D5F5130A-47F7-4837-BCCD-CF085A3B3648}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{DE9C8783-BEB0-4938-A839-EBA0B78E5C60}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{C0B12E0E-A461-4952-BED7-0C09A93ECA2B}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{DE9C8783-BEB0-4938-A839-EBA0B78E5C60}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Enable User</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_ENABLE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;

              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{B48354DA-C6EE-4018-A4FD-65B6550E2D38}</guid>
					<name>Generate Password</name>
					<enabled>yes</enabled>
					<description>Generates a random password</description>
					<version>1.0.3</version>
					<versioncomment/>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters>
							<param>
								<name>Password</name>
								<value1>Res@[UPPER(@[RANDOM(1000,2147483647,1)])]-@[LOWER(@[RANDOM(1000,2147483647,1)])]</value1>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{1B36AA6D-AEE9-48EA-AA82-57A45C6EEF27}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer></variablescontainer>
					</task>
					<task>
						<properties>
							<type>WAIT</type>
							<guid>{1B36AA6D-AEE9-48EA-AA82-57A45C6EEF27}</guid>
							<description>Postpone Job</description>
							<enabled>yes</enabled>
							<comments/>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<askconsoleuser>no</askconsoleuser>
							<wait unit="second">1</wait>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{17DB6E8C-90F6-48DD-9155-097398A78758}</guid>
					<name>Not working: Set Expiration</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.7</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{2470DE9C-B69A-4FE7-839B-BC0A88851739}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Experation time</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Format:
YYYY-MM-DDThh:mm:ss

YYYY - represents year
MM - represents month
DD - represents day
T - represents start of time section
hh - represents hours
mm - represents minutes
ss - represents seconds</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>yes</force>
									<required>yes</required>
									<validation validationmask="0000-00-00T00:00:00" validationliteral="____-__-__T__:__:__">yes</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{CCD07986-8575-4A5D-B350-FA57E4C1DF71}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{5AF61F68-C539-4D2E-A06F-AAFE8267E69F}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{CCD07986-8575-4A5D-B350-FA57E4C1DF71}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Set expiration date for user account</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'
$userfld_expiration_time = '$[Experation time]'
#exptime in YYYY-MM-DDThh:mm:ss format

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_SET_EXPIRATION&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:datetime"&gt;$userfld_expiration_time&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_EXPIRATION_TIME&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK - expiration time set
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{F2CBC17B-6903-43DB-BD3E-4FFA76438DF8}</guid>
					<name>Not Working: Unset Expiration</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.4</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{9906BC27-2590-4F48-9934-0F96C79058B3}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{E3229EEA-EB4F-4225-8752-9024E4C4594C}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{3FBD3670-5220-4BDB-97AD-1CC5BF130F52}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{E3229EEA-EB4F-4225-8752-9024E4C4594C}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Unset User expiration</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_RESET_LAST_AUTH_TIME&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:datetime"&gt;&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_EXPIRATION_TIME&lt;/attributeID&gt;
                        &lt;attributeOptions xsi:type="BASIC-TYPES:AttributeOptions"&gt;
                            &lt;null&gt;true&lt;/null&gt;
                        &lt;/attributeOptions&gt;
              &lt;/attributes&gt;
              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK - Expiration unset
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{0B302BB1-8A09-4C77-BC31-5AF392CEEBD0}</guid>
					<name>Query User Properties</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.6</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{FBBE1229-1202-4DEE-8000-30EB95FBCAB6}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{C04B53B7-6679-4F4B-96B5-A777D9A36576}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{87588EDD-26FF-4798-BF56-B8954BA2D9FE}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{C04B53B7-6679-4F4B-96B5-A777D9A36576}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Query User properties</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'

$userfld_assigned_digipass = ''
$userfld_backend_auth = ''
$userfld_create_time = ''
$userfld_description = ''
$userfld_disabled = ''
$userfld_email = ''
$userfld_expired = ''
$userfld_group_list = ''
$userfld_has_dp = ''
$userfld_lastauthreq_time = ''
$userfld_local_auth = ''
$userfld_lock_count = ''
$userfld_locked = ''
$userfld_mobile = ''
$userfld_modify_time = ''
$userfld_offline_auth_enabled = ''
$userfld_organizational_unit = ''
$userfld_phone = ''
$userfld_status = ''
$userfld_use_dp_from_user_domain = ''
$userfld_use_dp_from_user_id = ''
$userfld_username = ''


# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_VIEW&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#Create result
for ($count = 0; $count -lt $xml.envelope.body.userExecuteResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.userExecuteResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "USERFLD_ASSIGNED_DIGIPASS") {
            $userfld_assigned_digipass = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_BACKEND_AUTH") {
            $userfld_backend_auth = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_CREATE_TIME") {
            $userfld_create_time = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_DESCRIPTION") {
            $userfld_description = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_DISABLED") {
            $userfld_disabled = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_EMAIL") {
            $userfld_email = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_EXPIRED") {
            $userfld_expired = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_GROUP_LIST") {
            $userfld_group_list = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_HAS_DP") {
            $userfld_has_dp = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_LASTAUTHREQ_TIME") {
            $userfld_lastauthreq_time = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_LOCK_COUNT") {
            $userfld_lock_count = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_LOCKED") {
            $userfld_locked = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_MOBILE") {
            $userfld_mobile = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_MODIFY_TIME") {
            $userfld_modify_time = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_OFFLINE_AUTH_ENABLED") {
            $userfld_offline_auth_enabled = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_ORGANIZATIONAL_UNIT") {
            $userfld_organizational_unit = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_PHONE") {
            $userfld_phone = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_STATUS") {
            $userfld_status = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_USE_DP_FROM_USER_DOMAIN") {
            $userfld_use_dp_from_user_domain = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_USE_DP_FROM_USER_ID") {
            $userfld_use_dp_from_user_id = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
    elseif ($AttributeID -Match "USERFLD_USERNAME") {
            $userfld_username = $xml.Envelope.Body.userExecuteResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return Result:
# One string: UserID; Domain; Assigned Digipass; Backend authentication enabled; Account create time; Description; Disabled; Email; Expired; Group List; Has Digipass?; Last authentication request time; local authentication enabled?; Total times locked; Account locked?; Mobile number; Last modify time; Offline authentication enabled?; organization unit; phone number; status; digipass user domain; use digipass from other user; username
$return = "$userfld_userid;$userfld_domain;$userfld_assigned_digipass;$userfld_backend_auth;$userfld_create_time;$userfld_description;$userfld_disabled;$userfld_email;$userfld_expired;$userfld_group_list;$userfld_has_dp;$userfld_lastauthreq_time;$userfld_local_auth;$userfld_lock_count;$userfld_locked;$userfld_mobile;$userfld_modify_time;$userfld_offline_auth_enabled;$userfld_organizational_unit;$userfld_phone;$userfld_status;$userfld_use_dp_from_user_domain;$userfld_use_dp_from_user_id;$userfld_username"
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{D64F48AF-B979-43C2-9024-C505809ED57A}</guid>
					<name>Reset Last Auth time</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.5</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{FAC22DF8-FAEC-4E53-B100-8AB3DF3665D9}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{06742B89-98F7-4B11-87AF-4FF6DE4F0DEB}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{46A2D683-E297-4389-9667-73163AD38D1E}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{06742B89-98F7-4B11-87AF-4FF6DE4F0DEB}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Reset Last authentication time</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_RESET_LAST_AUTH_TIME&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;

              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Result OK
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{E320ECE5-2488-49DF-9B46-4F9E3CC57E58}</guid>
					<name>Reset Password</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.5</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{AD13A8C6-8DAD-4E8A-BEC1-FEC5410A6A54}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{37284DC2-169F-48F7-B957-844E32771FF4}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{E0417C9D-E7DC-4FC2-A82D-8CDCE35D8D79}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{37284DC2-169F-48F7-B957-844E32771FF4}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Reset password</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_RESET_PASSWORD&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;

              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK - password reset
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{0EB80F35-4582-4BCA-A3CE-7F1825E5FBAE}</guid>
					<name>Set Password</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.6</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{8E7E707C-FBFA-45EE-9241-4E05212AD5CD}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>New Password</name>
								<value1/>
								<value2/>
								<value3/>
								<type>5</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{0E796E92-8D7A-49BB-93B2-0031D1741A11}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{20A32CB6-F769-4EE0-B007-E1BCC2FCC3C2}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{0E796E92-8D7A-49BB-93B2-0031D1741A11}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Set user (temporary) password</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'
$userfld_new_password = '$[New Password]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_RESET_PASSWORD&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_new_password&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_NEW_PASSWORD&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_new_password&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_CONFIRM_NEW_PASSWORD&lt;/attributeID&gt;
              &lt;/attributes&gt;
              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK - Password set
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{285DD936-E687-43FB-970C-B6DD4CBCF123}</guid>
					<name>Unlock User</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.4</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{F05DE8A4-B5C9-4ED2-805C-C9E3D6AD9D12}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{1FD48ED3-226F-4360-A7B7-91CA42693D08}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{4887E859-8A4E-4E2E-9E17-D19D77449592}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{1FD48ED3-226F-4360-A7B7-91CA42693D08}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Unlock user account</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_UNLOCK&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;

              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK - User unlocked
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
			<module>
				<properties>
					<guid>{45EF80DB-B3DB-4C8C-A508-6C1F6F4B8D7E}</guid>
					<name>Update User</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.11</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<separators/>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
							<folder>
								<name>Useradmin</name>
								<description/>
								<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
							</folder>
						</folder>
					</folderpath>
					<deleteusedresources>yes</deleteusedresources>
				</properties>
				<tasks>
					<task hidden="yes">
						<limitinvoke>no</limitinvoke>
						<parameters identifier="{A91AC435-6B7C-4246-B41F-E3CB602D2FA3}">
							<param>
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Username</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Full name of the user</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Email</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Phone</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars
</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Mobile</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars
</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Description</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 1024 chars</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>LocalAuth</name>
								<value1>default</value1>
								<value2>default;none;digipass only;digipass/password;digipass or password</value2>
								<value3>Default;None;Digipass Only;Digipass/Password;Digipass or Password</value3>
								<type>1</type>
								<description>Default: the value from the related policy is
used.

None: no local authentication is performed.

Digipass Only: the user can only authenticate using their DIGIPASS.

DIGIPASS/Password: As long as the grace period for the DIGIPASS authenticatorhas not expired, the user can use either their authenticator
or their static password to log in. After the grace period has expired, only authentications with DIGIPASS can be performed.

DIGIPASS or Password: The user can use both their DIGIPASS authenticator or their static password for authentication, independent of the grace period. Use of this authentication mode is subject to licensing.</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>BackendAuth</name>
								<value1>default</value1>
								<value2>default;none;if needed;always</value2>
								<value3>Default;None;If needed;Always</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>Disabled</name>
								<value1>false</value1>
								<value2>true;false</value2>
								<value3>True;False</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>Locked</name>
								<value1>false</value1>
								<value2>true;false</value2>
								<value3>True;False</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>OfflineAuthEnabled</name>
								<value1>Default</value1>
								<value2>Default;Yes;No</value2>
								<value3>Default;Yes;No</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<selection/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
							</param>
							<param>
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
							</param>
							<param>
								<name>SessionID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Admin SessionID</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>VdpDeliveryMethod</name>
								<value1>default</value1>
								<value2>email;SMS;Voice;default</value2>
								<value3>Email;SMS;Voice;Default</value3>
								<type>3</type>
								<description>The delivery method for Virtual DIGIPASS messages.
This overrides the general delivery
method specified in the user policy.
Comma separated string of at
most two delivery methods.
Supported values:
n Email
n SMS
n Voice</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>vdpsigndeliverymethod</name>
								<value1>default</value1>
								<value2>email;sms;voice;default</value2>
								<value3>Email;SMS;Voice;default</value3>
								<type>3</type>
								<description>The delivery method for virtual signature messages.
This overrides the general delivery
method specified in the user policy.

Comma separated string of at
most two delivery methods.
Supported values:
n Email
n SMS
n Voice</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param>
								<name>VdpSignMdcProfile</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The Message Delivery Component (MDC) profile
for virtual signature messages. This takes
precedence over the MDC profile specified in
the user policy.</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>vdpMdcProfile</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The Message Delivery Component (MDC) profile
for Virtual DIGIPASS messages. This takes
precedence over the MDC profile specified in
the user policy.</description>
								<hint>Please provide the necessary input</hint>
								<selection/>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<conditions>
							<condition guid="{440EC2E0-E401-422C-84B6-2E912A11098C}">
								<expressions/>
								<operator>AND</operator>
								<actiontrue>3</actiontrue>
								<when>0</when>
								<action>3</action>
								<enabled>yes</enabled>
							</condition>
						</conditions>
						<variablescontainer><categories><category><guid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</guid><name>Vasco IdentyKey</name></category></categories><variables><variable><guid>{C7EDCDFA-AA63-4F28-9A59-BB5B9D1F2BAF}</guid><name>VascoPassword</name><description/><type>1</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1></value1></details></variable><variable><guid>{AA88FA04-FCEC-413A-8057-71A0E92CAB37}</guid><name>VascoAdmin</name><description/><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>admin</value1></details></variable><variable><guid>{06FDA549-C95E-47F0-8F00-0136033B0E45}</guid><name>VascoSOAPurl</name><description>Value must be:
https://[servername in certificate]:8888

Please note that you have to import the server self signed certificate into the trusted root certificate autorities of the server that runs the ROA agent.</description><type>0</type><parentguid>{33748F2B-8586-479C-B084-DCE4E09A7A67}</parentguid><details><value1>https://10.109.62.115:8888</value1></details></variable></variables></variablescontainer>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{4868AC58-9361-49D5-8FDB-4874093C81CD}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Open Admin Session (get Admin Token)</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$password = '^[VascoPassword]'
$username = '^[VascoAdmin]'
$url = '^[VascoSOAPurl]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
&lt;adm:logon&gt;
&lt;attributeSet&gt;

&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$username&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_USERID&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:string"&gt;$password&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;attributes&gt;
&lt;value xsi:type="xsd:unsignedInt"&gt;0&lt;/value&gt;
&lt;attributeID&gt;CREDFLD_PASSWORD_FORMAT&lt;/attributeID&gt;
&lt;/attributes&gt;
&lt;/attributeSet&gt;
&lt;/adm:logon&gt;
&lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.logonResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Error " +$xml.Envelope.Body.logonResponse.results.errorStack.errors.errorCode + " " + $xml.Envelope.Body.logonResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {
#loop through returned values to find sessionID
for ($count = 0; $count -lt $xml.envelope.body.logonResponse.results.resultAttribute.attributes.Count; $count++)
{ 
    $AttributeID = $xml.envelope.body.logonResponse.results.resultAttribute.attributes[$count].attributeID
    if ($AttributeID -Match "CREDFLD_SESSION_ID") {
            $SessionID = $xml.Envelope.Body.logonResponse.results.resultAttribute.attributes[$count].value.'#text'
        }
}

# Return SessionID
$SessionID
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[SessionID]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
					<task>
						<properties>
							<type>PWRSHELL</type>
							<guid>{440EC2E0-E401-422C-84B6-2E912A11098C}</guid>
							<description>Execute Windows PowerShell Script</description>
							<enabled>yes</enabled>
							<comments>Update user properties</comments>
							<onerror>fail</onerror>
						</properties>
						<settings>
							<username/>
							<password encrypted="yes"/>
							<usescript>yes</usescript>
							<source># variables to parse into xml
$sessionID = '$[SessionID]'
$url = '^[VascoSOAPurl]'

$userfld_userid = '$[UserID]'
$userfld_domain = '$[Domain]'
$userfld_email = '$[Email]'
$userfld_mobile = '$[Mobile]'
$userfld_description = '$[Description]'
$userfld_local_auth = '$[LocalAuth]'
$userfld_backend_auth = '$[BackendAuth]'
$userfld_disabled = '$[Disabled]'
$userfld_locked = '$[Locked]'
$userfld_offline_auth_enabled = '$[OfflineAuthEnabled]'
$userfld_phone = '$[Phone]'
$userfld_username = '$[Username]'

$userfld_vdp_delivery_method = '$[VdpDeliveryMethod]'
$userfld_vdp_sign_delivery_method = '$[VdpSignDeliveryMethod]'
#switch ; to , and replace default to nothing
$userfld_vdp_delivery_method = $userfld_vdp_delivery_method.replace(";",",")
if ($userfld_vdp_delivery_method.Contains("default")) {
    $userfld_vdp_delivery_method = $userfld_vdp_delivery_method.replace(",default","")
    $userfld_vdp_delivery_method = $userfld_vdp_delivery_method.replace("default","")
    }
$userfld_vdp_sign_delivery_method = $userfld_vdp_sign_delivery_method.replace(";",",")
if ($userfld_vdp_sign_delivery_method.Contains("default")) {
    $userfld_vdp_sign_delivery_method = $userfld_vdp_sign_delivery_method.replace(",default","")
    $userfld_vdp_sign_delivery_method = $userfld_vdp_sign_delivery_method.replace("default","")
    }
$userfld_vdp_mdc_profile = '$[VdpSignMdcProfile]'
$userfld_vdp_sign_mdc_profile = '$[VdpSignMdcProfile]'

# create xmlbody
$Batch = [XML] @"
&lt;soapenv:Envelope
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:adm="http://www.vasco.com/IdentikeyServer/IdentikeyTypes/Administration"&gt;
&lt;soapenv:Header/&gt;
&lt;soapenv:Body&gt;
        &lt;adm:userExecute&gt;
            &lt;sessionID&gt;$sessionID&lt;/sessionID&gt;
            &lt;cmd&gt;USERCMD_UPDATE&lt;/cmd&gt;
            &lt;attributeSet&gt;
              &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_userid&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERID&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_domain&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DOMAIN&lt;/attributeID&gt;
              &lt;/attributes&gt;
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_username&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_USERNAME&lt;/attributeID&gt;
              &lt;/attributes&gt;  
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_email&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_EMAIL&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_mobile&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_MOBILE&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_description&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DESCRIPTION&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_local_auth&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_LOCAL_AUTH&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_backend_auth&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_BACKEND_AUTH&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:boolean"&gt;$userfld_disabled&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_DISABLED&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:boolean"&gt;$userfld_locked&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_LOCKED&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_offline_auth_enabled&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_OFFLINE_AUTH_ENABLED&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_phone&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_PHONE&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_vdp_delivery_method&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_VDP_DELIVERY_METHOD&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_vdp_mdc_profile&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_VDP_MDC_PROFILE&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_vdp_sign_delivery_method&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_VDP_SIGN_DELIVERY_METHOD&lt;/attributeID&gt;
              &lt;/attributes&gt;              
            &lt;attributes&gt;
                &lt;value xsi:type="xsd:string"&gt;$userfld_vdp_sign_mdc_profile&lt;/value&gt;
                &lt;attributeID&gt;USERFLD_VDP_SIGN_MDC_PROFILE&lt;/attributeID&gt;
              &lt;/attributes&gt;              

              &lt;/attributeSet&gt;
            &lt;adminDomainInfoList/&gt;
        &lt;/adm:userExecute&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;
"@

# post xml
$results=Invoke-WebRequest -Uri $url -Method Post -ContentType "text/xml" -Body $Batch -UseBasicParsing

[xml]$xml=$results

# check error codes
$statuscode = $xml.Envelope.Body.userExecuteResponse.results.resultCodes.returnCode
if ($statuscode -ne "0") {
    #error raised, return error and exit
        $errorcode = "Statuscode " + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCode + ' - ' + $xml.Envelope.Body.userExecuteResponse.results.errorStack.errors.errorDesc
        $errorcode
        exit $statuscode
    }
Else {

# Return Status OK - properties modified 
$return = $xml.Envelope.Body.userExecuteResponse.results.resultcodes.returnCodeEnum + ";" + $xml.Envelope.Body.userExecuteResponse.results.resultcodes.statusCodeEnum
$return
}</source>
							<scriptext>ps1</scriptext>
							<outputwidth>80</outputwidth>
							<timeout>10</timeout>
							<terminate>no</terminate>
							<setexitcodeparameter parse="no">$[ExitCode]</setexitcodeparameter>
							<setoutparameter parse="no">$[Result]</setoutparameter>
							<snapins/>
							<overrideexecutionpolicy>no</overrideexecutionpolicy>
							<usex86psonx64>no</usex86psonx64>
						</settings>
					</task>
				</tasks>
			</module>
		</modules>
		<resources/>
		<runbooks>
			<runbook>
				<properties>
					<guid>{627B8256-C0A3-4891-BEC9-A68E88D8F314}</guid>
					<name>Assign Digipass to user</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.10</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<parameters>
							<param ref="module" guid="{681EED44-17CF-402E-B940-26FCD935F652}" name="Assign Digipass" linked="no">
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{681EED44-17CF-402E-B940-26FCD935F652}" type="module">
										<param>UserID</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{681EED44-17CF-402E-B940-26FCD935F652}" name="Assign Digipass" linked="no">
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{681EED44-17CF-402E-B940-26FCD935F652}" type="module">
										<param>Domain</param>
									</module>
									<module guid="{F20AE6D6-EB55-4C4B-895B-4A1C1CA5CFB8}" type="module">
										<param>Domain</param>
									</module>
								</selection>
							</param>
							<param>
								<name>Digipass_Serial</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection>
									<module type="module" guid="{F20AE6D6-EB55-4C4B-895B-4A1C1CA5CFB8}" linktype="2">
										<param>Digipass_serial</param>
									</module>
									<module type="module" guid="{681EED44-17CF-402E-B940-26FCD935F652}" linktype="0">
										<param>Digipass_Serial</param>
									</module>
									<module type="module" guid="{DA717B6D-B972-4EDE-93D9-EDF8DEED4F61}" linktype="0">
										<param>Digipass_Serial</param>
									</module>
								</selection>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
							</param>
							<param>
								<name>Digipass type</name>
								<value1>MOB35</value1>
								<value2>MOB30;MOB35</value2>
								<value3>Mobile digipass 30;Mobile Digipass 35</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection>
									<module type="module" guid="{F20AE6D6-EB55-4C4B-895B-4A1C1CA5CFB8}" linktype="0">
										<param>Digipass type</param>
									</module>
								</selection>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
							</param>
							<param ref="module" guid="{681EED44-17CF-402E-B940-26FCD935F652}" name="Assign Digipass" linked="no">
								<name>Grace_Period</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Grace period in days</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{681EED44-17CF-402E-B940-26FCD935F652}" type="module">
										<param>Grace_Period</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{DA717B6D-B972-4EDE-93D9-EDF8DEED4F61}" name="Get Digipass Activation and QR code" linked="no">
								<name>ActivationCode</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{DA717B6D-B972-4EDE-93D9-EDF8DEED4F61}" type="module" linktype="2">
										<param>ActivationCode</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{DA717B6D-B972-4EDE-93D9-EDF8DEED4F61}" name="Get Digipass Activation and QR code" linked="no">
								<name>QR_Code</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{DA717B6D-B972-4EDE-93D9-EDF8DEED4F61}" type="module" linktype="2">
										<param>QR_Code</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{681EED44-17CF-402E-B940-26FCD935F652}" name="Assign Digipass" linked="no">
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
								<selection>
									<module guid="{681EED44-17CF-402E-B940-26FCD935F652}" type="module" linktype="2">
										<param>ExitCode</param>
									</module>
									<module guid="{DA717B6D-B972-4EDE-93D9-EDF8DEED4F61}" type="module" linktype="2">
										<param>ExitCode</param>
									</module>
									<module guid="{F20AE6D6-EB55-4C4B-895B-4A1C1CA5CFB8}" type="module" linktype="2">
										<param>ExitCode</param>
									</module>
								</selection>
							</param>
						</parameters>
						<jobs>
							<job>
								<guid>{2DDB63D0-1B72-4ED1-A665-C982A70B874A}</guid>
								<properties>
									<enabled>yes</enabled>
									<name>List first free digipass serial</name>
									<timeout>0</timeout>
									<offlineagentsnextboot>no</offlineagentsnextboot>
									<wol>no</wol>
									<selectoneagent>yes</selectoneagent>
									<what type="module">{F20AE6D6-EB55-4C4B-895B-4A1C1CA5CFB8}</what>
									<whatname>List first free digipass serial</whatname>
									<who type="team">{11BBBD33-C4C3-4DF1-818C-7A2347A70530}</who>
									<use_runbookparam>no</use_runbookparam>
									<whoname>Vasco Servers</whoname>
									<onerror>fail</onerror>
								</properties>
							</job>
							<job>
								<guid>{FC5D10BD-656A-4392-9F80-D3A2317A20DC}</guid>
								<properties>
									<enabled>yes</enabled>
									<name>Assign Digipass</name>
									<timeout>0</timeout>
									<offlineagentsnextboot>no</offlineagentsnextboot>
									<wol>no</wol>
									<selectoneagent>yes</selectoneagent>
									<what type="module">{681EED44-17CF-402E-B940-26FCD935F652}</what>
									<whatname>Assign Digipass</whatname>
									<who type="team">{11BBBD33-C4C3-4DF1-818C-7A2347A70530}</who>
									<use_runbookparam>no</use_runbookparam>
									<whoname>Vasco Servers</whoname>
									<onerror>fail</onerror>
								</properties>
								<conditions>
									<condition guid="{FC5D10BD-656A-4392-9F80-D3A2317A20DC}">
										<expressions>
											<expression guid="{B883B90C-FE22-4F4D-808E-B12D5663B074}">
												<operand>ExitCode</operand>
												<operator>=</operator>
												<value>0</value>
												<type>8</type>
											</expression>
											<expression guid="{678E558C-8D28-4F34-A29B-AB6F885A6B6C}">
												<operand>Digipass_Serial</operand>
												<operator>NOT LIKE</operator>
												<value></value>
												<type>8</type>
											</expression>
										</expressions>
										<operator>AND</operator>
										<actiontrue>3</actiontrue>
										<setparametertrue>no</setparametertrue>
										<parametertrue>UserID</parametertrue>
										<when>0</when>
										<action>1</action>
										<setparameter>no</setparameter>
										<parameter>UserID</parameter>
										<enabled>yes</enabled>
									</condition>
								</conditions>
							</job>
							<job>
								<guid>{C78998FD-6BAD-473A-A121-F6E5104804A5}</guid>
								<properties>
									<enabled>yes</enabled>
									<name>Digipass Activation code</name>
									<timeout>0</timeout>
									<offlineagentsnextboot>no</offlineagentsnextboot>
									<wol>no</wol>
									<selectoneagent>yes</selectoneagent>
									<what type="module">{DA717B6D-B972-4EDE-93D9-EDF8DEED4F61}</what>
									<whatname>Get Digipass Activation and QR code</whatname>
									<who type="team">{11BBBD33-C4C3-4DF1-818C-7A2347A70530}</who>
									<use_runbookparam>no</use_runbookparam>
									<whoname>Vasco Servers</whoname>
									<onerror>fail</onerror>
								</properties>
								<conditions>
									<condition guid="{C78998FD-6BAD-473A-A121-F6E5104804A5}">
										<expressions>
											<expression guid="{AD3737F9-3AE0-4923-B4CB-DD16A2D6DF9A}">
												<operand>ExitCode</operand>
												<operator>=</operator>
												<value>0</value>
												<type>8</type>
											</expression>
										</expressions>
										<operator>AND</operator>
										<actiontrue>3</actiontrue>
										<setparametertrue>no</setparametertrue>
										<parametertrue>UserID</parametertrue>
										<when>0</when>
										<action>1</action>
										<setparameter>no</setparameter>
										<parameter>UserID</parameter>
										<enabled>yes</enabled>
									</condition>
								</conditions>
							</job>
						</jobs>
						<separators/>
						<limitinvoke>no</limitinvoke>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{0F234CBF-3870-49C8-B59E-D60F7DF8CDEE}</guid>
							</folder>
						</folder>
					</folderpath>
				</properties>
			</runbook>
			<runbook>
				<properties>
					<guid>{6484AB1C-B86E-43E4-B54B-9ABFAF29627C}</guid>
					<name>Unassign Digipass from user</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.0</version>
					<versioncomment>Initial version</versioncomment>
					<properties>
						<parameters>
							<param ref="module" guid="{79A04073-1A82-4578-9FC2-0DA5DFA4CA56}" name="Unassign Digipass" linked="no">
								<name>Digipass_Serial</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{79A04073-1A82-4578-9FC2-0DA5DFA4CA56}" type="module">
										<param>Digipass_Serial</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{79A04073-1A82-4578-9FC2-0DA5DFA4CA56}" name="Unassign Digipass" linked="no">
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{79A04073-1A82-4578-9FC2-0DA5DFA4CA56}" type="module">
										<param>Domain</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{79A04073-1A82-4578-9FC2-0DA5DFA4CA56}" name="Unassign Digipass" linked="no">
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
								<selection>
									<module guid="{79A04073-1A82-4578-9FC2-0DA5DFA4CA56}" type="module" linktype="2">
										<param>ExitCode</param>
									</module>
								</selection>
							</param>
						</parameters>
						<jobs>
							<job>
								<guid>{EC9CAC72-0DE6-44FB-97B2-055720CE27B3}</guid>
								<properties>
									<enabled>yes</enabled>
									<name>Unassign Digipass</name>
									<timeout>0</timeout>
									<offlineagentsnextboot>no</offlineagentsnextboot>
									<wol>no</wol>
									<selectoneagent>yes</selectoneagent>
									<what type="module">{79A04073-1A82-4578-9FC2-0DA5DFA4CA56}</what>
									<whatname>Unassign Digipass</whatname>
									<who type="team">{11BBBD33-C4C3-4DF1-818C-7A2347A70530}</who>
									<use_runbookparam>no</use_runbookparam>
									<whoname>Vasco Servers</whoname>
									<onerror>fail</onerror>
								</properties>
							</job>
						</jobs>
						<separators/>
						<limitinvoke>no</limitinvoke>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</guid>
							<folder>
								<name>Digipass</name>
								<description/>
								<guid>{0F234CBF-3870-49C8-B59E-D60F7DF8CDEE}</guid>
							</folder>
						</folder>
					</folderpath>
				</properties>
			</runbook>
			<runbook>
				<properties>
					<guid>{86C174E9-6DD2-4D7A-82A8-97DD8D6EFFCB}</guid>
					<name>List Domains</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.8</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<parameters>
							<param ref="module" guid="{E90B449F-9C82-4761-A4F1-7704F44FDCD8}" name="List Domains" linked="no">
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
								<selection>
									<module guid="{E90B449F-9C82-4761-A4F1-7704F44FDCD8}" type="module" linktype="2">
										<param>ExitCode</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{E90B449F-9C82-4761-A4F1-7704F44FDCD8}" name="List Domains" linked="no">
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
								<selection>
									<module guid="{E90B449F-9C82-4761-A4F1-7704F44FDCD8}" type="module" linktype="2">
										<param>Result</param>
									</module>
								</selection>
							</param>
						</parameters>
						<jobs>
							<job>
								<guid>{B3938BD3-D9FC-48F1-B5DB-1C0EDDB16D5D}</guid>
								<properties>
									<enabled>yes</enabled>
									<name>List Domains</name>
									<timeout>0</timeout>
									<offlineagentsnextboot>no</offlineagentsnextboot>
									<wol>no</wol>
									<selectoneagent>yes</selectoneagent>
									<what type="module">{E90B449F-9C82-4761-A4F1-7704F44FDCD8}</what>
									<whatname>List Domains</whatname>
									<who type="team">{11BBBD33-C4C3-4DF1-818C-7A2347A70530}</who>
									<use_runbookparam>no</use_runbookparam>
									<whoname>Vasco Servers</whoname>
									<onerror>fail</onerror>
								</properties>
							</job>
						</jobs>
						<separators/>
						<limitinvoke>no</limitinvoke>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</guid>
							<folder>
								<name>Domains</name>
								<description/>
								<guid>{3C3873A7-F1A0-4A29-B7CE-585433AC1842}</guid>
							</folder>
						</folder>
					</folderpath>
				</properties>
			</runbook>
			<runbook>
				<properties>
					<guid>{82C9AE8D-3872-45F7-8755-2011BA3E6D8A}</guid>
					<name>Create Password</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.2</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<parameters>
							<param>
								<name>Password</name>
								<value1>@[RANDOM(1000,2147483647,1]</value1>
								<value2/>
								<value3/>
								<type>0</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<selection>
									<module type="module" guid="{B48354DA-C6EE-4018-A4FD-65B6550E2D38}" linktype="2">
										<param>Password</param>
									</module>
								</selection>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
							</param>
						</parameters>
						<jobs>
							<job>
								<guid>{3798817E-1DD4-460F-B4D9-B75DAEBD7F2F}</guid>
								<properties>
									<enabled>yes</enabled>
									<name>Generate Password</name>
									<timeout>0</timeout>
									<offlineagentsnextboot>no</offlineagentsnextboot>
									<wol>no</wol>
									<selectoneagent>yes</selectoneagent>
									<what type="module">{B48354DA-C6EE-4018-A4FD-65B6550E2D38}</what>
									<whatname>Generate Password</whatname>
									<who type="team">{11BBBD33-C4C3-4DF1-818C-7A2347A70530}</who>
									<use_runbookparam>no</use_runbookparam>
									<whoname>Vasco Servers</whoname>
									<onerror>fail</onerror>
								</properties>
							</job>
						</jobs>
						<separators/>
						<limitinvoke>no</limitinvoke>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</guid>
							<folder>
								<name>UserAdmin</name>
								<description/>
								<guid>{760C256C-24A3-488D-90F5-F1F776B0C232}</guid>
							</folder>
						</folder>
					</folderpath>
				</properties>
			</runbook>
			<runbook>
				<properties>
					<guid>{6A109C4A-5CDC-46D0-B3F7-B3F0927DDF15}</guid>
					<name>Create User</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.15</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<parameters>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>UserID</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Username</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Full name of the user</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Username</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Description</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 1024 chars</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Description</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Domain</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>OrganizationUnit</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars
OU needs to be available in the domain</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>OrganizationUnit</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Password</name>
								<value1/>
								<value2/>
								<value3/>
								<type>5</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Password</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Email</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Email</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Mobile</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars
</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Mobile</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Phone</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 64 chars
</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Phone</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>BackendAuth</name>
								<value1>default</value1>
								<value2>default;none;if needed;always</value2>
								<value3>Default;None;If needed;Always</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>BackendAuth</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>OfflineAuthEnabled</name>
								<value1>default</value1>
								<value2>default;yes;no</value2>
								<value3>Default;Yes;No</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>OfflineAuthEnabled</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>LocalAuth</name>
								<value1>default</value1>
								<value2>default;none;digipass only;digipass/password;digipass or password</value2>
								<value3>Default;None;Digipass Only;Digipass/Password;Digipass or Password</value3>
								<type>1</type>
								<description>Default: the value from the related policy is
used.

None: no local authentication is performed.

Digipass Only: the user can only authenticate using their DIGIPASS.

DIGIPASS/Password: As long as the grace period for the DIGIPASS authenticatorhas not expired, the user can use either their authenticator
or their static password to log in. After the grace period has expired, only authentications with DIGIPASS can be performed.

DIGIPASS or Password: The user can use both their DIGIPASS authenticator or their static password for authentication, independent of the grace period. Use of this authentication mode is subject to licensing.</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>LocalAuth</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Disabled</name>
								<value1>false</value1>
								<value2>true;false</value2>
								<value3>True;False</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Disabled</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>Locked</name>
								<value1>false</value1>
								<value2>true;false</value2>
								<value3>True;False</value3>
								<type>1</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
								</inputoptions>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module">
										<param>Locked</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{370F7679-0227-48E2-96CD-74F359144031}" name="Create User" linked="no">
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
								<selection>
									<module guid="{370F7679-0227-48E2-96CD-74F359144031}" type="module" linktype="2">
										<param>ExitCode</param>
									</module>
								</selection>
							</param>
						</parameters>
						<jobs>
							<job>
								<guid>{B50FB713-AAE4-410F-BF5D-9EC260C4FA35}</guid>
								<properties>
									<enabled>yes</enabled>
									<name>Create User</name>
									<timeout>0</timeout>
									<offlineagentsnextboot>no</offlineagentsnextboot>
									<wol>no</wol>
									<selectoneagent>yes</selectoneagent>
									<what type="module">{370F7679-0227-48E2-96CD-74F359144031}</what>
									<whatname>Create User</whatname>
									<who type="team">{11BBBD33-C4C3-4DF1-818C-7A2347A70530}</who>
									<use_runbookparam>no</use_runbookparam>
									<whoname>Vasco Servers</whoname>
									<onerror>fail</onerror>
								</properties>
								<conditions>
									<condition guid="{B50FB713-AAE4-410F-BF5D-9EC260C4FA35}">
										<expressions/>
										<operator>AND</operator>
										<actiontrue>3</actiontrue>
										<setparametertrue>no</setparametertrue>
										<parametertrue>UserID</parametertrue>
										<when>0</when>
										<action>1</action>
										<setparameter>no</setparameter>
										<parameter>UserID</parameter>
										<enabled>yes</enabled>
									</condition>
								</conditions>
							</job>
						</jobs>
						<separators/>
						<limitinvoke>no</limitinvoke>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</guid>
							<folder>
								<name>UserAdmin</name>
								<description/>
								<guid>{760C256C-24A3-488D-90F5-F1F776B0C232}</guid>
							</folder>
						</folder>
					</folderpath>
				</properties>
			</runbook>
			<runbook>
				<properties>
					<guid>{F0BA318B-198D-4B37-AF5C-483142BAAD3E}</guid>
					<name>Delete user</name>
					<enabled>yes</enabled>
					<description/>
					<version>1.0.4</version>
					<versioncomment>Updated version</versioncomment>
					<properties>
						<parameters>
							<param ref="module" guid="{B4482ADE-76FF-44AE-921C-E48599BE7629}" name="Delete User" linked="no">
								<name>Domain</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>Up to 255 chars</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{B4482ADE-76FF-44AE-921C-E48599BE7629}" type="module">
										<param>Domain</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{B4482ADE-76FF-44AE-921C-E48599BE7629}" name="Delete User" linked="no">
								<name>UserID</name>
								<value1/>
								<value2/>
								<value3/>
								<type>0</type>
								<description>The UserID, in whatever form the calling application provides it.
No specific format is required.
Up to 64 chars</description>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="yes" eraseprev="no">yes</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>yes</required>
									<validation>no</validation>
								</inputoptions>
								<selection>
									<module guid="{B4482ADE-76FF-44AE-921C-E48599BE7629}" type="module">
										<param>UserID</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{B4482ADE-76FF-44AE-921C-E48599BE7629}" name="Delete User" linked="no">
								<name>ExitCode</name>
								<type>0</type>
								<description/>
								<inputtiming>
									<importbb showprev="yes">no</importbb>
									<schedulejob showprev="yes">no</schedulejob>
								</inputtiming>
								<selection>
									<module guid="{B4482ADE-76FF-44AE-921C-E48599BE7629}" type="module" linktype="2">
										<param>ExitCode</param>
									</module>
								</selection>
							</param>
							<param ref="module" guid="{B4482ADE-76FF-44AE-921C-E48599BE7629}" name="Delete User" linked="no">
								<name>Result</name>
								<value1/>
								<value2/>
								<value3/>
								<type>4</type>
								<description/>
								<hint>Please provide the necessary input</hint>
								<inputtiming>
									<importbb showprev="no" eraseprev="no">no</importbb>
									<schedulejob showprev="no" eraseprev="no">no</schedulejob>
								</inputtiming>
								<inputoptions>
									<confirm>no</confirm>
									<force>no</force>
									<required>no</required>
								</inputoptions>
								<selection>
									<module guid="{B4482ADE-76FF-44AE-921C-E48599BE7629}" type="module" linktype="2">
										<param>Result</param>
									</module>
								</selection>
							</param>
						</parameters>
						<jobs>
							<job>
								<guid>{EB794756-7079-4B50-A9D0-C32F285D03A2}</guid>
								<properties>
									<enabled>yes</enabled>
									<name>Delete User</name>
									<timeout>0</timeout>
									<offlineagentsnextboot>no</offlineagentsnextboot>
									<wol>no</wol>
									<selectoneagent>yes</selectoneagent>
									<what type="module">{B4482ADE-76FF-44AE-921C-E48599BE7629}</what>
									<whatname>Delete User</whatname>
									<who type="team">{11BBBD33-C4C3-4DF1-818C-7A2347A70530}</who>
									<use_runbookparam>no</use_runbookparam>
									<whoname>Vasco Servers</whoname>
									<onerror>fail</onerror>
								</properties>
							</job>
						</jobs>
						<separators/>
						<limitinvoke>no</limitinvoke>
					</properties>
					<folderpath>
						<folder>
							<name>Vasco</name>
							<description/>
							<guid>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</guid>
							<folder>
								<name>UserAdmin</name>
								<description/>
								<guid>{760C256C-24A3-488D-90F5-F1F776B0C232}</guid>
							</folder>
						</folder>
					</folderpath>
				</properties>
			</runbook>
		</runbooks>
		<teams/>
		<projectfolders/>
		<modulefolders>
			<folder>
				<guid>{2010A14A-13F1-412C-9B80-02919F3C0D25}</guid>
				<name>Vasco</name>
				<description/>
				<parent/>
			</folder>
			<folder>
				<guid>{0A4FB10C-50AD-4664-B06C-8C4AFE6C4177}</guid>
				<name>admin</name>
				<description/>
				<parent>{2010A14A-13F1-412C-9B80-02919F3C0D25}</parent>
			</folder>
			<folder>
				<guid>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</guid>
				<name>Digipass</name>
				<description/>
				<parent>{2010A14A-13F1-412C-9B80-02919F3C0D25}</parent>
			</folder>
			<folder>
				<guid>{6812E568-0299-4E0A-8AED-D47542D02D05}</guid>
				<name>Other</name>
				<description/>
				<parent>{DAF9A21B-18C8-41AA-A303-B4E615DF31C1}</parent>
			</folder>
			<folder>
				<guid>{76339061-E4E8-4773-8B48-403E2A7BFA2C}</guid>
				<name>Domains</name>
				<description/>
				<parent>{2010A14A-13F1-412C-9B80-02919F3C0D25}</parent>
			</folder>
			<folder>
				<guid>{16BF9C9C-42FC-441A-90B3-225FA0CBC05F}</guid>
				<name>Organizational Units</name>
				<description/>
				<parent>{2010A14A-13F1-412C-9B80-02919F3C0D25}</parent>
			</folder>
			<folder>
				<guid>{65FEDF5E-18B3-4E65-9FD2-6D90A134C65E}</guid>
				<name>Useradmin</name>
				<description/>
				<parent>{2010A14A-13F1-412C-9B80-02919F3C0D25}</parent>
			</folder>
		</modulefolders>
		<resourcefolders/>
		<runbookfolders>
			<folder>
				<guid>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</guid>
				<name>Vasco</name>
				<description/>
				<parent/>
			</folder>
			<folder>
				<guid>{0F234CBF-3870-49C8-B59E-D60F7DF8CDEE}</guid>
				<name>Digipass</name>
				<description/>
				<parent>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</parent>
			</folder>
			<folder>
				<guid>{3C3873A7-F1A0-4A29-B7CE-585433AC1842}</guid>
				<name>Domains</name>
				<description/>
				<parent>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</parent>
			</folder>
			<folder>
				<guid>{760C256C-24A3-488D-90F5-F1F776B0C232}</guid>
				<name>UserAdmin</name>
				<description/>
				<parent>{D6EC8E40-F0EB-49E7-A717-115A3A4FB2E8}</parent>
			</folder>
		</runbookfolders>
		<teamfolders/>
	</buildingblock>
</AutomationManager>
